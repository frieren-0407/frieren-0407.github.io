<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Only for Chill</title>
        <link rel="shortcut icon" type="page-icon" href="media/bg2.jpg">
        <link rel="stylesheet" href="style.css">
        <script src="https://kit.fontawesome.com/ca262bb4da.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="container">
            <div class="music-player">
                <nav>
                    <div class="circle">
                        <i class="fa-solid fa-angle-left"></i>
                    </div>
                    <button class="circle">
                        <i class="fa-solid fa-bars-staggered"></i>
                    </button>
                </nav>
                        <img src="media/bg2.jpg" class="cover" id="Disc">

                <h1>
                    Chocolate Lemon
                </h1>
                <p>
                    Mitsukiyo
                </p>
                <audio id="song">
                    <source src="media/Chocolate Lemon (1).mp3" type="audio/mpeg">
                </audio>
                <input type="range" value="0" id="progress">
                
                <div class="controls">
                    <div onclick="playPrevious()">
                        <i class="fa-solid fa-backward-fast"></i>
                    </div>
                    <div onclick="playPause()">
                        <i class="fa-solid fa-play" id="ctrlIcon"></i>
                    </div>
                    <div onclick="playNext()">
                        <i class="fa-solid fa-forward-fast"></i>
                    </div>
                </div>
            </div>
            <div class="playlist-container" style="display: none;">
                <h2 class="playlist-title">Playlist</h2>
                <ul class="playlist">
                    
                </ul>
            </div>
            
        </div>
        <script>
            let progress = document.getElementById("progress");
            let song = document.getElementById("song");
            let ctrlIcon = document.getElementById("ctrlIcon");
            
            song.onloadedmetadata = function() {
    progress.max = song.duration || Infinity; // Thiết lập duration, nếu không có thì sử dụng Infinity
    progress.value = song.currentTime;
    song.onended = function() {
        playNext(); // Chuyển sang bài hát tiếp theo khi bài hát kết thúc
    };
};

song.oncanplaythrough = function() {
    song.play(); // Bắt đầu phát bài hát sau khi có thể play thông qua hết
};
            
            function playPause(){
                if(ctrlIcon.classList.contains("fa-pause")){
                    song.pause();
                    ctrlIcon.classList.remove("fa-pause");
                    ctrlIcon.classList.add("fa-play");
                    document.getElementById("Disc").classList.remove("rotating-disc");
                }
                else{
                    song.play();
                    ctrlIcon.classList.remove("fa-play");
                    ctrlIcon.classList.add("fa-pause");
                    document.getElementById("Disc").classList.add("rotating-disc");
                }
            }
            if(song.play()){
                setInterval(()=>{
                    progress.value = song.currentTime;
                },300)
            }
            progress.onchange = function(){
                song.play();
                song.currentTime = progress.value;
                ctrlIcon.classList.remove("fa-play");
                ctrlIcon.classList.add("fa-pause");
            }
            const playlistElement = document.querySelector('.playlist');
        
            let playlist = [
    { name: 'Chocolate Lemon', artist: 'Mitsukiyo', file: 'media/Chocolate Lemon (1).mp3' },
    { name: 'Nights', artist: 'Masayoshi Takanaka', file: 'media/Nights.mp3' },
    { name: 'Wave', artist: 'Antônio Carlos Jobim', file: 'media/Wave.mp3' },
    { name: 'Tiny Little Adiantum', artist: '3L', file: 'media/Tiny Little Adiantum.mp3'},
    { name: 'Corcovado', artist: 'Stan Getz', file: 'media/Corcovado.mp3'},
    { name: 'Someday my prince will come', artist: 'Bill Evans', file: 'media/Someday my prince will come.mp3'},
    { name: 'The girl from Ipanema', artist: 'Antônio Carlos Jobim', file: 'media/The girl from Ipanema.mp3'},
    { name: 'Alice In Wonderland', artist: 'Bill Evan', file: 'media/Alice In Wonderland.mp3'},
    { name: 'Beleza Pura', artist: 'Masayoshi Takanaka', file: 'media/Beleza Pura.mp3'},
    { name: 'おはようまたあした', artist: 'Ho-Kago Tea Time', file: 'media/おはようまたあした.mp3'},
    { name: 'Galactic Funk - Live at The Ryogoku Kokugikan Tokyo April 1985', artist: 'Casiopeia', file: 'media/Galactic Funk - Live at The Ryogoku Kokugikan Tokyo April 1985.mp3'},
    { name: 'Medley', artist: 'Kaoru & Sentaro Duo', file: 'media/BUNKASAI Medley.mp3'},
    { name: 'Sakamichi no Apollon OST - But not for me', artist: 'Yoko Kanno (Junichi Perform)', file: 'media/But not for me (Sakamichi No Apollon OST).mp3'},
    { name: 'Machi No Dorufin', artist: 'Kingo Hamada', file: 'media/Machi No Dorufin.mp3'},
    { name: 'Roi nhu da ngay ngo', artist: 'Hong Nhung & Hoai Sa', file: 'media/Roi nhu da ngay ngo.mp3'},
    { name: 'Ao Lua Ha Dong (Live)', artist: 'Tuan Ngoc', file: 'media/Aó Lụa Hà Đông (Live).mp3'},
    { name: 'Moanin', artist: 'Art Blakey', file: 'media/Moanin.mp3'}

]
    playlist.forEach(song => {
    const listItem = document.createElement('li');
    listItem.textContent = `${song.name} - ${song.artist}`;
    playlistElement.appendChild(listItem);
});
;
let currIndex = 0;

function playNext() {
    currIndex = (currIndex + 1) % playlist.length;
    changeTrack(currIndex);
}

function playPrevious() {
    currIndex = (currIndex - 1 + playlist.length) % playlist.length;
    changeTrack(currIndex);
}

function changeTrack(index) {
// Kiểm tra nếu bài hát đang chạy
const isPlaying = !song.paused;

song.src = playlist[index].file;
document.querySelector('h1').innerText = playlist[index].name;
document.querySelector('p').innerText = playlist[index].artist;
song.load(); // Tải lại bài hát mới

song.onended = function() {
        playNext(); // Chuyển sang bài hát tiếp theo khi bài hát kết thúc
    };

    song.play(); // Phát bài hát mới

}

function rotateImage(element) {
element.classList.toggle("active");
}
const barsStaggered = document.querySelector('.fa-bars-staggered');
const playlistContainer = document.querySelector('.playlist-container');

barsStaggered.addEventListener('click', function() {
    if (playlistContainer.style.display === 'none' || playlistContainer.style.display === '') {
        playlistContainer.style.display = 'block';
    } else {
        playlistContainer.style.display = 'none';
    }
});
document.addEventListener("DOMContentLoaded", function() {
    const playlistElement = document.querySelector('.playlist');
    const playlistTitle = document.querySelector('.playlist-title');

    // Kiểm tra nếu playlist chưa được in ra trước đó
    if (!isPlaylistRendered) {
        // Thêm các phần tử playlist vào DOM
        playlist.forEach(song => {
            const listItem = document.createElement('li');
            listItem.textContent = `${song.name} - ${song.artist}`;
            playlistElement.appendChild(listItem);
        });

        // Đặt cờ cho biết playlist đã được in ra
        isPlaylistRendered = true;
    }
});

        </script>
    </body>
    
</html>

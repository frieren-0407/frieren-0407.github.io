<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Music Player</title>
        <link rel="stylesheet" href="style.css">
        <script src="https://kit.fontawesome.com/ca262bb4da.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="container">
            <div class="music-player">
                <nav>
                    <div class="circle">
                        <i class="fa-solid fa-angle-left"></i>
                    </div>
                    <div class="circle">
                        <i class="fa-solid fa-bars-staggered"></i>
                    </div>
                </nav>
                        <img src="media/bg2.jpg" class="cover" id="Disc">

                <h1>
                    Chocolate Lemon
                </h1>
                <p>
                    Mitsukiyo
                </p>
                <audio id="song">
                    <source src="media/Chocolate Lemon (1).mp3" type="audio/mpeg">
                </audio>
                <input type="range" value="0" id="progress">
                
                <div class="controls">
                    <div onclick="playPrevious()">
                        <i class="fa-solid fa-backward-fast"></i>
                    </div>
                    <div onclick="playPause()">
                        <i class="fa-solid fa-play" id="ctrlIcon"></i>
                    </div>
                    <div onclick="playNext()">
                        <i class="fa-solid fa-forward-fast"></i>
                    </div>
                </div>
            </div>
        </div>
        <script>
            let progress = document.getElementById("progress");
            let song = document.getElementById("song");
            let ctrlIcon = document.getElementById("ctrlIcon");
            
            song.onloadedmetadata = function(){
                progress.max = song.duration;
                progress.value = song.currentTime;
            }
            
            function playPause(){
                if(ctrlIcon.classList.contains("fa-pause")){
                    song.pause();
                    ctrlIcon.classList.remove("fa-pause");
                    ctrlIcon.classList.add("fa-play");
                    document.getElementById("Disc").classList.remove("rotating-disc");
                }
                else{
                    song.play();
                    ctrlIcon.classList.remove("fa-play");
                    ctrlIcon.classList.add("fa-pause");
                    document.getElementById("Disc").classList.add("rotating-disc");
                }
            }
            if(song.play()){
                setInterval(()=>{
                    progress.value = song.currentTime;
                },300)
            }
            progress.onchange = function(){
                song.play();
                song.currentTime = progress.value;
                ctrlIcon.classList.remove("fa-play");
                ctrlIcon.classList.add("fa-pause");
            }
            let playlist = [
    { name: 'Chocolate Lemon', artist: 'Mitsukiyo', file: 'media/Chocolate Lemon (1).mp3' },
    { name: 'Nights', artist: 'Masayoshi Takanaka', file: 'media/Nights.mp3' },
    { name: 'Wave', artist: 'Antônio Carlos Jobim', file: 'media/Wave.mp3' },

];
let currIndex = 0;

function playNext() {
    currIndex = (currIndex + 1) % playlist.length;
    changeTrack(currIndex);
}

function playPrevious() {
    currIndex = (currIndex - 1 + playlist.length) % playlist.length;
    changeTrack(currIndex);
}

function changeTrack(index) {
// Kiểm tra nếu bài hát đang chạy
const isPlaying = !song.paused;

song.src = playlist[index].file;
document.querySelector('h1').innerText = playlist[index].name;
document.querySelector('p').innerText = playlist[index].artist;
song.load(); // Tải lại bài hát mới

// Nếu bài hát đang chạy, không cần gọi playPause() để tránh dừng bài hát
if (isPlaying) {
    song.play();
}
}

function rotateImage(element) {
element.classList.toggle("active");
}


        </script>
    </body>
    
</html>